<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>May 10th 2025 - Camila & Johannes</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
	<!-- <link rel="stylesheet" href="./milligram.min.css" />  -->
	<link rel="stylesheet" href="../style.css" /> 
	<link rel="stylesheet" href="../menu.css" /> 
	<link rel="stylesheet" href="../rsvp.css" /> 
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>♥️</text></svg>">


</head>
<body>

<script>
    window.language = 'pt'; // Set the language parameter
</script>

	<main>
		<div class="rsvp-section">
			<div class='title'><h1><span id="string__rsvp__title"></span> </h1></div>
			<div class="form-section">
				<p class="instructions"><span id="string__rsvp__instructions"></span> </p>
				<form id="rsvp-form">
					<div id="attendee-fields">
						<!-- Attendee fields will be added here dynamically -->
					</div>
					<div id="confirmation-message">
					<p>
<span id="string__rsvp__confirmation"></span> 
					</p>
				</div>
					<div class="form-controls">
						<button type="button" class="button button-clear" onclick="addAttendee()"><span id="string__rsvp__addAttendee"></span> </button>
						<button type="submit" class="button">
						<span id="string__rsvp__submit"></span> </button>
					</div>
				</form>
				
			</div>
		</div>

		<script>
			let attendeeCount = 0;

			var en_language_strings = {
				remove: "Remove",
				firstName: "First Name",
				lastName: "Last Name",
				email: 'Email',
				eventSelect: 'Select Event',
				attendee: 'Attendee',
				notAttending: 'Not attending',
				optionPreWedParty: 'Pre-Wedding Party (9th of May, starts at ~7pm)',
				optionPreWedBoat: 'Pre-Wedding Boat Tour (9th of May, starts at ~2pm)',
				optionPreWedding: 'Wedding Ceremony (10th of May, at ~2pm)',
			};

			var de_language_strings = {
			    remove: "Entfernen",
			    firstName: "Vorname",
			    lastName: "Nachname",
			    email: "E-Mail",
			    eventSelect: "Veranstaltung auswählen",
			    attendee: "Teilnehmer",
			    notAttending: "Nimmt nicht teil",
			    optionPreWedParty: "Vorhochzeitsfeier (9. Mai, beginnt um ~19 Uhr)",
			    optionPreWedBoat: "Vorhochzeits-Bootstour (9. Mai, beginnt um ~14 Uhr)",
			    optionPreWedding: "Hochzeitszeremonie (10. Mai, um ~14 Uhr)",
			};
			var pt_br_language_strings = {
			    remove: "Remover",
			    firstName: "Primeiro Nome",
			    lastName: "Sobrenome",
			    email: "E-mail",
			    eventSelect: "Selecione o Evento",
			    attendee: "Participante",
			    notAttending: "Não comparecendo",
			    optionPreWedParty: "Festa Pré-Casamento (9 de maio, começa às ~19h)",
			    optionPreWedBoat: "Passeio de Barco Pré-Casamento (9 de maio, começa às ~14h)",
			    optionPreWedding: "Cerimônia de Casamento (10 de maio, às ~14h)",
			};

			languageStrings = window.language ==='en'? en_language_strings : window.language ==='de'? de_language_strings:  pt_br_language_strings;




			function addAttendee() {
				const attendeeFields = document.getElementById('attendee-fields');

				const today = new Date().toISOString().split('T')[0];
				const attendeeDiv = document.createElement('div');
				attendeeDiv.setAttribute('id', 'attendee-' + attendeeCount);
				attendeeDiv.setAttribute('class', 'attendee-wrapper');
				attendeeDiv.innerHTML = `
				<div class="attendee_container">
				<input type="hidden" name="attendees[${attendeeCount}][date]" value="${today}" required>
				<div class="attendee__title">
				<h3 class="attendee-counter">${languageStrings["attendee"]} ${attendeeCount + 1}</h3>
				<button type="button" class="removeAttendee button button-clear" onclick="removeAttendee(${attendeeCount})">Remove</button>
				</div>
				<div class="attendee__group">
				<div class="attendee__variable">
				<label for="first-name-${attendeeCount}">${languageStrings["firstName"]}:</label>
				<input type="text" name="attendees[${attendeeCount}][firstName]" required>
				</div>
				<div class="attendee__variable">
				<label for="last-name-${attendeeCount}">${languageStrings["lastName"]}:</label>
				<input type="text" name="attendees[${attendeeCount}][lastName]" required>
				</div>
				<div class="attendee__variable">
				<label for="email-${attendeeCount}">${languageStrings["email"]}:</label>
				<input type="email" name="attendees[${attendeeCount}][email]" required>
				</div>
				<div class="attendee__variable select">
				<p style="margin-bottom: 10px" id="selectEventLabel-${attendeeCount}">${languageStrings["eventSelect"]}:</p>
				<label>
				<input type="checkbox" class="attendeeEventCheckbox-${attendeeCount}" name="attendees[${attendeeCount}][event_boattour]" checked="checked" value="pre wedding boat tour" > ${languageStrings["optionPreWedBoat"]}
				</label>
				<label>
				<input type="checkbox" class="attendeeEventCheckbox-${attendeeCount}" name="attendees[${attendeeCount}][event_preparty]" checked="checked" value="pre wedding sunset party" > ${languageStrings["optionPreWedParty"]}
				</label>
				<label>
				<input type="checkbox" class="attendeeEventCheckbox-${attendeeCount}" name="attendees[${attendeeCount}][event_wedding]" checked="checked" value="wedding" > ${languageStrings["optionPreWedding"]}
				</label>
			<label>
				<input type="checkbox" class="attendeeEventCheckbox-${attendeeCount}" id="checkboxNotAttending-${attendeeCount}" name="attendees[${attendeeCount}][event_notattending]" data-attendee="${attendeeCount}" value="not-attending" > ${languageStrings["notAttending"]}
				</label>
				</div>
				</div>
				</div>
				`;
				attendeeFields.appendChild(attendeeDiv);
		
		const specialCheckbox = document.getElementById('checkboxNotAttending-'+attendeeCount); 

	    specialCheckbox.addEventListener('change', function() {

	    const otherCheckboxes = document.querySelectorAll(`input[type='checkbox'].attendeeEventCheckbox-${this.dataset.attendee}:not(#checkboxNotAttending-${this.dataset.attendee})`);

        if (this.checked) {
            otherCheckboxes.forEach(checkbox => {
                checkbox.disabled = true;
                checkbox.checked = false;
            });
        } else {
            otherCheckboxes.forEach(checkbox => {
                checkbox.disabled = false;
            });
        }
    });




				attendeeCount++;


			}

			function removeAttendee(id) {
				const attendeeDiv = document.getElementById('attendee-' + id);
				attendeeDiv.remove();
				updateAttendeeCounters();
				attendeeCount--;
			}

			function updateAttendeeCounters() {
				const counters = document.querySelectorAll('.attendee-counter');
				counters.forEach((counter, index) => {
					counter.textContent = `Attendee ${index + 1}`;
				});

        // Update the input names to keep them sequential
				const inputs = document.querySelectorAll('#attendee-fields input, #attendee-fields label');
				inputs.forEach(input => {
					const name = input.getAttribute('name');
					if (name) {
						const newName = name.replace(/\[.*?\]/, `[${Array.prototype.indexOf.call(input.closest('.attendee_container').parentElement.children, input.closest('.attendee_container'))}]`);
						input.setAttribute('name', newName);
					}
				});
			}

		document.getElementById('rsvp-form').addEventListener('submit', function(event) {
    event.preventDefault();

var getSelectedEvents = function(formData, index) {
    const selectedEvents = [];
    const eventNames = ['event_wedding', 'event_preparty', 'event_boattour']; // Replace with actual event names
    const eventValues = {
    	event_wedding:'Wedding', 
    	event_preparty: 'Pre-Wedding Party',
    	event_boattour: 'Pre-Wedding Boat Tour'
    }

    eventNames.forEach(eventName => {
        if (formData.get(`attendees[${index}][${eventName}]`)) {
            selectedEvents.push(eventName);
        }
    });

    return selectedEvents.length > 0 ? selectedEvents.join(', ') : 'not attend';
}


    const formData = new FormData(this);
    const attendees = [];

    for (let i = 0; i < attendeeCount; i++) {
        const attendee = {
            firstName: formData.get(`attendees[${i}][firstName]`),
            lastName: formData.get(`attendees[${i}][lastName]`),
            email: formData.get(`attendees[${i}][email]`),
            event: getSelectedEvents(formData, i),
            date: formData.get(`attendees[${i}][date]`)
        };

        if (attendee.firstName && attendee.lastName && attendee.email && attendee.event) {
            attendees.push(attendee);
        }

        let checkboxValidation = false;
        const checkboxes = document.querySelectorAll(`input[type="checkbox"].attendeeEventCheckbox-${i}`);

        checkboxes.forEach(checkbox => {
	        if (checkbox.checked) {
	            checkboxValidation = true;
	        }
	    })

        const warningMessage = document.getElementById('selectEventLabel-'+i);
	    if (checkboxValidation === false) {
	        warningMessage.style.color = 'darkred';
	        warningMessage.style.fontWeight = 'bold';
	        return
		}

	        warningMessage.style.color = 'black';
	        warningMessage.style.fontWeight = 'normal';
    }

    const jsonData = JSON.stringify({ attendees });

    fetch('https://hook.eu1.make.com/vpg4ialld8bw9jyrp54wfnvclwdo8v2a', {
        method: 'POST',
        body: jsonData,
        headers: {
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.text())
    .then(data => {
        document.getElementById('confirmation-message').style.display = 'block';
        document.getElementById('rsvp-form').reset();
    })
    .catch(error => {
        console.error('Error:', error);
    });
});



    // Initial attendee added on page load
			addAttendee();
		</script>



          <div class="menu__section"></div>
<script src="../loader.js"></script>



        </main>


    </body>
    </html>
